"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2667],{3905:(e,n,r)=>{r.d(n,{Zo:()=>y,kt:()=>m});var t=r(7294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function l(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function i(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=t.createContext({}),c=function(e){var n=t.useContext(s),r=n;return e&&(r="function"==typeof e?e(n):l(l({},n),e)),r},y=function(e){var n=c(e.components);return t.createElement(s.Provider,{value:n},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,y=i(e,["components","mdxType","originalType","parentName"]),u=c(r),d=a,m=u["".concat(s,".").concat(d)]||u[d]||p[d]||o;return r?t.createElement(m,l(l({ref:n},y),{},{components:r})):t.createElement(m,l({ref:n},y))}));function m(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=r.length,l=new Array(o);l[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[u]="string"==typeof e?e:a,l[1]=i;for(var c=2;c<o;c++)l[c]=r[c];return t.createElement.apply(null,l)}return t.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2040:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var t=r(7462),a=(r(7294),r(3905));const o={sidebar_position:1},l=void 0,i={unversionedId:"sql/\u7bc4\u4f8b-leetcode-SQL/day4-176. Second Highest Salary",id:"sql/\u7bc4\u4f8b-leetcode-SQL/day4-176. Second Highest Salary",title:"day4-176. Second Highest Salary",description:"",source:"@site/docs/03.sql/4.\u7bc4\u4f8b-leetcode-SQL/day4-176. Second Highest Salary.mdx",sourceDirName:"03.sql/4.\u7bc4\u4f8b-leetcode-SQL",slug:"/sql/\u7bc4\u4f8b-leetcode-SQL/day4-176. Second Highest Salary",permalink:"/myBlog_docusaurus/docs/sql/\u7bc4\u4f8b-leetcode-SQL/day4-176. Second Highest Salary",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"day3-1667. Fix Names in a Table",permalink:"/myBlog_docusaurus/docs/sql/\u7bc4\u4f8b-leetcode-SQL/day3-1667. Fix Names in a Table"},next:{title:"day4-1795. Rearrange Products Table",permalink:"/myBlog_docusaurus/docs/sql/\u7bc4\u4f8b-leetcode-SQL/day4-1795. Rearrange Products Table"}},s={},c=[],y={toc:c},u="wrapper";function p(e){let{components:n,...r}=e;return(0,a.kt)(u,(0,t.Z)({},y,r,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"/*\nTable: Employee\n\n+-------------+------+\n| Column Name | Type |\n+-------------+------+\n| id          | int  |\n| salary      | int  |\n+-------------+------+\nid is the primary key column for this table.\nEach row of this table contains information about the salary of an employee.\n \n\nWrite an SQL query to report the second highest salary from the Employee table. If there is no second highest salary, the query should report null.\n\nThe query result format is in the following example.\n\n \n\nExample 1:\n\nInput: \nEmployee table:\n+----+--------+\n| id | salary |\n+----+--------+\n| 1  | 100    |\n| 2  | 200    |\n| 3  | 300    |\n+----+--------+\nOutput: \n+---------------------+\n| SecondHighestSalary |\n+---------------------+\n| 200                 |\n+---------------------+\nExample 2:\n\nInput: \nEmployee table:\n+----+--------+\n| id | salary |\n+----+--------+\n| 1  | 100    |\n+----+--------+\nOutput: \n+---------------------+\n| SecondHighestSalary |\n+---------------------+\n| null                |\n+---------------------+\n*/\n\n// \u89e3\u6cd51 \nSELECT MAX(CASE WHEN rank_num=2 THEN salary ELSE NULL END) AS SecondHighestSalary\nFROM (\n    SELECT salary, ROW_NUMBER() OVER (ORDER BY salary DESC) AS rank_num\n    FROM Employee\n) temp\n\nor \n\nSELECT SUM(IF( rank_num = 2 , salary , NULL)) AS SecondHighestSalary\nFROM (\n    SELECT id, salary,\n           ROW_NUMBER() OVER (ORDER BY salary DESC) AS rank_num\n    FROM Employee\n) temp\nWHERE rank_num = 2;\n\n/*\n\u89e3\u6cd5 1 \u90fd\u9700\u8981\u5c0d\u7a7a\u767d\u503c\u7528\u51fd\u6578\u53d6\u503c\uff0c\u624d\u6703\u5728\u7a7a\u767d\u6642 return NULL\n\nex : MAX , MIN , AVG , SUM \u90fd\u884c\n*/\n\n// \u89e3\u6cd52 leetcode \u89e3\u7b54\n SELECT\n     (SELECT DISTINCT\n             Salary\n         FROM\n             Employee\n         ORDER BY Salary DESC\n         LIMIT 1 OFFSET 1) AS SecondHighestSalary\n\n/*\n\u89e3\u6cd5 2 \u5b50\u67e5\u8a62\u5982\u679c\u627e\u5230\u7a7a\u767d\u6703 return NULL\n\u5982\u679c\u6ca1\u7528\u5b50\u67e5\u8be2\uff0c\u4f1a\u6709\u4e00\u6837\u7684\u95ee\u9898\uff1a\u5f53\u6ca1\u6709\u85aa\u6c34\u7b2c\u4e8c\u9ad8\u7684\u4eba\u7684\u65f6\u5019\uff0c\u8fd4\u56de\u7684\u4e0d\u662fnull\u503c\u3002\n\nskill : \u5b50\u67e5\u8a62 , NULL\n\n*/\n\n// \u89e3\u6cd53 \u7db2\u53cb\nSELECT MAX(Salary) AS SecondHighestSalary FROM Employee\nWHERE Salary NOT IN (SELECT MAX(Salary) FROM Employee);\n\n/*\n\u89e3\u6cd5 3 \u7528 WHERE + MAX \u904e\u6ffe\u6700\u9ad8\n\n\u518d\u4f7f\u7528 MAX \u4e00\u6b21\u5c31\u662f\u6b21\u9ad8\n\nskill : \u5b50\u67e5\u8a62 , NULL\n\n*/\n")))}p.isMDXComponent=!0}}]);